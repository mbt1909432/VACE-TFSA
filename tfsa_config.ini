# TFSA Configuration for VACE
# This file contains the configuration parameters for TFSA (Training-Free Self-Attention)

[TFSA]
# Enable or disable TFSA enhancement
enabled = false

# Guidance scale γ (0.0 to 1.0)
# - 0.0: No TFSA (same as original VACE)
# - 0.3-0.5: Mild TFSA (recommended starting point)
# - 0.5-0.7: Medium TFSA (good balance)
# - 0.7-1.0: Strong TFSA (may oversmooth)
guidance_scale = 0.5

# Integration mode
# Options:
#   - augment: Blend original attention with TFSA (recommended)
#   - replace: Replace attention with TFSA entirely (experimental)
mode = augment

# Apply TFSA only to specific dimensions (optional)
# If both are false, TFSA is applied spatio-temporally
spatial_only = false
temporal_only = false

# Apply TFSA only to specific block indices (optional)
# Leave empty to apply to all blocks
# Example: [0, 1, 2, 10, 11, 12] applies TFSA to these blocks only
block_ids = []

# Dynamic guidance settings
[DynamicGuidance]
# Enable adaptive guidance that changes during inference
# This implements the cosine decay strategy from RepLDM
enabled = false

# Cosine decay parameters
delay_rate = 0.2  # η1: When to start applying guidance
decay_factor = 1.0  # β: Controls decay speed

# Initial and final guidance
initial_guidance = 0.8
final_guidance = 0.2

[Performance]
# Trade-off between quality and speed
# Higher values may improve quality but slow down inference
num_tfsa_iterations = 1

# Memory optimization
# Enable to reduce memory usage for large videos
enable_memory_efficient = false

[Advanced]
# Experimental features

# Use cached attention maps (trade memory for speed)
cache_attention_maps = false

# Apply TFSA only to specific layers
# Leave empty to apply to all layers
layer_indices = []

# Use mixed precision for TFSA computation
mixed_precision_tfsa = false
